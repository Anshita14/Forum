<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"  xmlns:sec="http://www.thymeleaf.org/extras/spring-security" xmlns:th="http://www.thymeleaf.org">
<head><title>Home | Social Forum</title>

    <!-- General CSS File -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.7.12/sweetalert2.min.css" rel="stylesheet" >
<!--     <link href="/static/Home _ UPSDM LMS_files/jquery.toast.min.css" rel="stylesheet" th:href="@{/Home _ UPSDM LMS_files/jquery.toast.min.css}">
 -->    
<!--  <link href="/static/Home _ UPSDM LMS_files/simplebar.css" rel="stylesheet" th:href="@{/Home _ UPSDM LMS_files/simplebar.css}">
 -->    
 <link href="/static/css/app.css" rel="stylesheet" th:href="@{/css/app.css}">
<!--    <link href="/static/Home _ UPSDM LMS_files/flags.css" rel="stylesheet"-->
<!--          th:href="@{/Home _ UPSDM LMS_files/flags.css}">-->


<!--   <link href="/static/Home _ UPSDM LMS_files/swiper-bundle.min.css" rel="stylesheet" th:href="@{/Home _ UPSDM LMS_files/swiper-bundle.min.css}">
       <link href="/static/Home _ UPSDM LMS_files/owl.carousel.min.css" rel="stylesheet" th:href="@{/Home _ UPSDM LMS_files/owl.carousel.min.css}">
       <link href="/static/Home _ UPSDM LMS_files/bootstrap.min.css" rel="stylesheet" th:href="@{/Home _ UPSDM LMS_files/bootstrap.min.css}"> -->
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    <link href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
    <link href="/static/css/lmsHome.css" rel="stylesheet" th:href="@{/css/lmsHome.css}">
    <link th:href="@{/css/Forum.css}" rel="stylesheet"></head>

<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.bundle.min.js"></script>
<body>
<div class="container-fluid" style="--bs-gutter-x: 0rem;">
<div class="row justify-content-center" style="background-image: linear-gradient(90deg, #f3c17c 0%, #991721 75%, #842c61 100%);">
    <div class="col-lg-8 col-sm-12">
        <img alt="forum hero" class="img-cover-dsp" th:src="@{/img/forumBg.png}">
    </div>
    <div class="col-lg-4 col-sm-12 d-flex align-items-center p-3">
        <div class="row" >
            <div class="col-12">
                <h1 class="font-36 text-light">
                    <span>Welcome to the world's largest social platform.</span><br>
                    <span>Are you feeling lucky</span>
                </h1>
                <p class="font-20 text-light mt-15">Whats on your mind?..Make a tweet about it.</p>
            </div>
            <div class="col-12 ">
                <form th:action="@{/social/post}" method="post" class="form row g-3 justify-content-center">
                    <textarea class="form-control" name="postContent" id="postContent" placeholder="Make Tweet" type="text" style="width: 95%;min-height: 115px;" required maxlength="500"></textarea>
                    <div id="charCount" style="color:white;" align="center"></div>
                    <a class="btn btn-light rounded-pill w-25 h-auto" th:href="@{/social/login}" sec:authorize="!isAuthenticated()" onclick="window.alert('Please login to Post Questions')">Post</a>
                    <button class="btn btn-light rounded-pill w-25 h-auto" type="submit" sec:authorize="isAuthenticated()">Post</button>
                </form>
            </div>
        </div>
    </div>
</div>
</div>
<div class="container mt-20 mb-20">
    <div class="forum-stat-section bg-white p-10"
         style="box-shadow: 0px 0px 20px 20px #00000021;border-radius: 6.3rem!important;">
        <div class="row">
            <div class="col-6 col-md-4">
                <div class="d-flex align-items-center justify-content-center flex-column">
                    <img alt="Forums" class="forum-stat-icon" th:src="@{/img/post.png}">
                    <span class="font-30 font-weight-bold text-secondary" th:text="${forumPostCount}">8</span>
                    <span class="font-16 font-weight-500 text-gray">Posts</span>
                </div>
            </div>

            <div class="col-6 col-md-4">
                <div class="d-flex align-items-center justify-content-center flex-column">
                    <img alt="Topics" class="forum-stat-icon" th:src="@{/img/replies.png}">
                    <span class="font-30 font-weight-bold text-secondary" th:text="${forumPostReplyCount}">10</span>
                    <span class="font-16 font-weight-500 text-gray">Replies</span>
                </div>
            </div>

            <div class="col-6 col-md-4">
                <div class="d-flex align-items-center justify-content-center flex-column">
                    <img alt="Posts" class="forum-stat-icon" th:src="@{/img/members.png}">
                    <span class="font-30 font-weight-bold text-secondary" th:text="${forumMemberCount}">19</span>
                    <span class="font-16 font-weight-500 text-gray">Members</span>
                </div>
            </div>

        </div>
    </div>
</div>
<div class="container-fluid mb-50" style="overflow: visible;">
    <div class="container" style="box-shadow: 0px 0px 20px 20px #00000021; border-radius: 20px; height: 200vh;">
        <div class="main-body py-4" style="height: 100%">
            <div class="inner-wrapper">
                <!-- Inner sidebar -->
                <div class="inner-sidebar">
                    <!-- Inner sidebar header -->
                    <div class="inner-sidebar-body p-0">
                        <div class="p-3 h-100" data-simplebar="init">
                            <div class="simplebar-wrapper" style="margin: -16px;">
                                <div class="simplebar-height-auto-observer-wrapper">
                                    <div class="simplebar-height-auto-observer"></div>
                                </div>
                                <div class="simplebar-mask">
                                    <div class="simplebar-offset" style="right: 0px; bottom: 0px;">
                                        <div class="simplebar-content-wrapper"
                                             style="height: 100%; overflow: hidden scroll;">
                                            <div class="simplebar-content" style="padding: 16px;">
                                                <nav class="nav nav-pills nav-gap-y-1 flex-column">
                                                    <a class="nav-link nav-link-faded has-icon active"
                                                       href="javascript:void(0)">All Post</a>
                                                    <a class="nav-link nav-link-faded has-icon"
                                                       href="javascript:void(0)">Replied Post</a>
                                                    <a class="nav-link nav-link-faded has-icon"
                                                       href="javascript:void(0)">Replied by
                                                        Instructor</a>
                                                    <a class="nav-link nav-link-faded has-icon"
                                                       href="javascript:void(0)">No Replies Yet</a>
                                                    <a class="nav-link nav-link-faded has-icon"
                                                       href="javascript:void(0)">Latest Post</a>
                                                </nav>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="simplebar-placeholder" style="width: 234px; height: 292px;"></div>
                            </div>
                            <div class="simplebar-track simplebar-horizontal" style="visibility: hidden;">
                                <div class="simplebar-scrollbar" style="width: 0px; display: none;"></div>
                            </div>
                            <div class="simplebar-track simplebar-vertical" style="visibility: visible;">
                                <div class="simplebar-scrollbar"
                                     style="height: 151px; display: block; transform: translate3d(0px, 0px, 0px);"></div>
                            </div>
                        </div>
                    </div>
                    <!-- /Inner sidebar body -->
                </div>
                <!-- /Inner sidebar -->

                <!-- Inner main -->
                <div class="inner-main">
                    <!-- Inner main header -->
                    <div class="inner-main-header">
                        <a class="nav-link nav-icon rounded-circle nav-link-faded mr-3 d-md-none" data-toggle="inner-sidebar" href="#"><i arrow_forward_ios class="material-icons"></i></a>
                        <select class="custom-select custom-select-sm w-auto mr-1">
                            <option value="" selected>Select Sector</option>
                            <option th:each="sector:${sectors}" th:text="${sector.sectorName}"></option>
                        </select>

                        <a class="nav-link nav-icon rounded-circle nav-link-faded mr-3 d-md-none"
                           data-toggle="inner-sidebar"
                           href="#"><i arrow_forward_ios class="material-icons"></i></a>
                        <select class="custom-select custom-select-sm w-auto mr-1" >
                            <option value="" selected>Select Course</option>
                        </select>
                    </div>
                    <!-- /Inner main header -->

                    <!-- Inner main body -->

                    <!-- Forum List -->
                    <div class="container inner-main-body p-2 p-sm-3" style="height: 100%">
                        <div class="mt-20">
                            <h2 class="section-title after-line">Latest Posts From Members</h2>
                            <div class="accordion-content-wrapper mt-15" id="accordionFaqAll" role="tablist"
                                 aria-multiselectable="true">
                                <div class="accordion-row rounded-sm shadow-lg border mt-20 py-20 px-35"
                                     th:each="forumPost:${forumPosts}">
                                    <div class="font-weight-bold font-14 text-secondary" role="tab" id="faqMain" onclick="hideReplies(this)">
                                        <div th:href="${'#'+forumPost.forumPostId}" aria-controls="collapseFaqMain"
                                             class="d-flex align-items-center justify-content-between collapsed"
                                             role="button" data-toggle="collapse" data-parent="#accordion"
                                             aria-expanded="false" >
                                            <img style="width:40px;height:40px; border-radius: 50%;" th:src="@{${'/data/forum/profileImg/'+ forumPost?.createdBy}}">
                                            <span class="mr-10 ml-10 text-center w-25" th:text="${'Posted By - '+forumPost.studentInfo.fullName }"></span>
                                            <span class="mr-10 ml-10" style="width: 65%; word-wrap: break-word;" th:text="${forumPost.postContent}"></span>
                                            <span class="mr-10 ml-10 text-center w-25" th:text="${'Posted On - ' + #dates.format(forumPost?.creationDate, 'dd/MM/yyyy')}"></span>
                                            <span class="material-icons btn btn-success" style="padding: 5px;margin: 0px;height: auto">expand_circle_down</span>
                                        </div>
                                    </div>
                                    <div th:id="${forumPost.forumPostId}" aria-labelledby="faqMain" class="px-30 py-20 m-2 collapse" role="tabpanel" style="box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 10px 5px inset; border-radius: 50px;">
                                        <div th:each="forumPostReply:${forumPost.forumPostReplies}" class="d-flex flex-row align-items-center justify-content-between mt-2 mb-2">
                                            <img style="width:30px;height:30px; border-radius: 50%;" th:src="@{${'/data/forum/profileImg/'+ forumPostReply?.createdBy}}">
<!--                                            <span class="mr-10 ml-10 text-center w-25" ></span>-->
                                            <span style="width: 70%; word-wrap: break-word;" th:text="${forumPostReply?.replyContent}"></span>
                                            <span style="font-size: 70%;display: grid" >
                                                <span th:text="${'Replied By - '+forumPostReply.studentInfo.fullName }"></span>
                                                <span th:text="${'Replied On - ' + #dates.format(forumPostReply?.replyDate, 'dd/MM/yyyy')}"></span>
                                            </span>
                                        </div>

                                        <form th:action="@{/student/forumReply}" method="post" class="mt-3">
                                            <div class="input-group mb-3">
                                                <input type="text" class="form-control" id="forumPostId" name="forumPostId" th:value="${forumPost?.forumPostId}" hidden>
                                                <input type="text" class="form-control" id="replyContent" name="replyContent" placeholder="Reply Here" maxlength="500" required>
                                                <div class="input-group-append">
                                                    <button class="btn btn-outline-success" style="height: 38px;" type="submit">Reply</button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /Forum List -->

            </div>
        </div>

        <!-- New Thread Modal -->
        <div aria-hidden="true" aria-labelledby="threadModalLabel" class="modal fade" id="threadModal" role="dialog"
             tabindex="-1">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <form>
                        <div class="modal-header d-flex align-items-center bg-primary text-white">
                            <h6 class="modal-title mb-0" id="threadModalLabel">New Discussion</h6>
                            <button aria-label="Close" class="close" data-dismiss="modal" type="button">
                                <span aria-hidden="true"></span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label for="threadTitle">Title</label>
                                <input autofocus="" class="form-control" id="threadTitle" placeholder="Enter title" type="text"/>
                            </div>
                            <textarea class="form-control summernote" style="display: none;"></textarea>

                            <div class="custom-file form-control-sm mt-3" style="max-width: 300px;">
                                <input class="custom-file-input" id="customFile" multiple="" type="file"/>
                                <label class="custom-file-label" for="customFile">Attachment</label>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-light" data-dismiss="modal" type="button">Cancel</button>
                            <button class="btn btn-primary" type="button">Post</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<footer class="bg-secondary position-relative user-select-none">
    <img style="width: 100%;" th:src="@{/Category/footerPic.png}">
</footer>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.7.12/sweetalert2.all.min.js"></script>
    <!-- Template JS File -->

<!--     Forum Post Character Limit -->

<script>
    const inputElement = document.getElementById('postContent');
    const charCountElement = document.getElementById('charCount');

    inputElement.addEventListener('input', () => {
        const currentLength = inputElement.value.length;
        const maxLength = parseInt(inputElement.getAttribute('maxlength'));

        charCountElement.textContent = `${currentLength}/${maxLength} characters`;

        if (currentLength > maxLength) {
            charCountElement.style.color = 'blue';
            alert('Character limit exceeded!');
        } else {
            charCountElement.style.color = 'white';
        }
    });
</script>


<script>
    function hideReplies(x){

        var repliesTag = x.nextElementSibling;

        if(repliesTag.style.display === 'block'){

            repliesTag.style.display = 'none';

        }else{

            repliesTag.style.display = 'block';

        }
    }
</script>
</body>
</html>